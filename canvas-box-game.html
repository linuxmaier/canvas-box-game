<!DOCTYPE html>
<html>
<head>
<!-- loads jquery 1.10.2 from the CDN -->
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.js"></script>
<!-- if the CDN is unaccessible for some reason, load the local copy -->
<script>
if (typeof jQuery == 'undefined') {
    document.write(unescape("%3Cscript src='jquery-1.10.2.js' type='text/javascript'%3E%3C/script%3E"));
}
</script>
<script>
//implements indexOf for arrays
if (!Array.prototype.indexOf) {
  Array.prototype.indexOf = function (searchElement , fromIndex) {
    var i,
        pivot = (fromIndex) ? fromIndex : 0,
        length;

    if (!this) {
      throw new TypeError();
    }

    length = this.length;

    if (length === 0 || pivot >= length) {
      return -1;
    }

    if (pivot < 0) {
      pivot = length - Math.abs(pivot);
    }

    for (i = pivot; i < length; i++) {
      if (this[i] === searchElement) {
        return i;
      }
    }
    return -1;
  };
}
</script>
<!-- load scripts and styles -->
<script type="text/javascript" src="shapes.js"></script>
<script type="text/javascript" src="physics.js"></script>
<script type="text/javascript" src="animation.js"></script>
<!-- Import vector math library. Thanks to Tudor Nita at www.cgrats.com -->
<script type="text/javascript" src="TS_vector2.js"></script>
<link rel="stylesheet" type="text/css" href="cbgstyle.css">

<title>Canvas Box Game</title>

</head>
<body>
<div id="app">
<div id="headSection">
<h1 id="mainHead">Canvas Box Game</h1>
</div>
<canvas id="boxGame" width=1200 height=720>Canvas did not render.</canvas>

</div>
<script>
//creates frame request callback based on browser
(function() {
  var requestAnimationFrame = window.requestAnimationFrame || window.mozRequestAnimationFrame || window.webkitRequestAnimationFrame || window.msRequestAnimationFrame;
  window.requestAnimationFrame = requestAnimationFrame;
})();


var gameCanvas = document.getElementById("boxGame");
var ctext = gameCanvas.getContext("2d");
var startTime = (new Date()).getTime();
//stores keypresses
var keys = [];
//contains object zones
var zone = [];

//sets registers keypresses as true for elements corresponding to keycodes
document.body.addEventListener("keydown", function(e) {keys[e.keyCode] = true;});
document.body.addEventListener("keyup", function(e) {keys[e.keyCode] = false;});
testRect1 = new Rectangle(0, 0, 100, 50, "#FFFFFF", true, gamePhysics, keys, [37, 38, 39, 40]);
testRect2 = new Rectangle(200, 0, 50, 100, "#000000", true, gamePhysics, keys, [65, 87, 68, 83]);

testCirc1 = new Circle(100, 100, 30, "#DDDDDD", gamePhysics);
testCirc2 = new Circle(50, 200, 40, "#222222", gamePhysics);
testCirc3 = new Circle(200, 300, 50, "#AAAAAA", gamePhysics);
testCirc4 = new Circle(20, 20, 20, "#888888", gamePhysics);
testCirc5 = new Circle(500, 100, 45, "#444444", gamePhysics);
testCirc6 = new Circle(75, 600, 25, "#666666", gamePhysics);

//objects in shapeArray are drawn in animation.js
var shapeArray = [testRect1, testRect2, testCirc1, testCirc2, testCirc3, testCirc4, testCirc5, testCirc6];
var confirmedCollisions = [];
requestAnimationFrame(function()  {animate(shapeArray, ctext, gameCanvas, confirmedCollisions, startTime);});
</script>
</body>
</html>
